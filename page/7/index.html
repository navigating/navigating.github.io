<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>On The Open Way</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="On The Open Way">
<meta property="og:url" content="http://navigating.github.io/page/7/index.html">
<meta property="og:site_name" content="On The Open Way">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On The Open Way">
<meta name="twitter:description">
<meta name="twitter:creator" content="@xujinghui">
  
    <link rel="alternative" href="/atom.xml" title="On The Open Way" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5554b1765137f9e84f6b5d1958c4bdfd";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  

  <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','W7_-_9WqoJq6hWaJJ8zZ','2.0.0');
</script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">On The Open Way</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">自信人生二百年，会当水击三千里！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/sitemap.xml">Sitemap</a>
        
      </nav>
      <nav id="sub-nav">	    
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>		
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://navigating.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2009/熊" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/熊/" class="article-date">
  <time datetime="2009-10-13T15:20:59.000Z" itemprop="datePublished">2009-10-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/熊/">熊</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>简介<br>　　熊，食肉目，是属于熊科的杂食性大型哺乳类，以肉食为主。从寒带到热带都有分布。躯体粗壮，四肢强健有力，头圆颈短，眼小吻长。前后肢均具有5指、趾，弯爪强硬，不能伸缩。跖行性。短尾隐于体毛内。毛色一致，厚而密。齿大，但不尖锐，裂齿不如其他食肉目动物发达。杂食性。行动缓慢，营地栖生活，善于爬树，也能游泳。嗅觉、听觉较为灵敏。毛皮、肉、脂、胆、掌均有较大经济价值，有时对养蜂业、农、牧、果树等造成危害。种类较少，全世界仅有7种，我国有4种：马来熊、棕熊、亚洲黑熊、大熊猫。除澳洲、非洲南部外，多有分布。<br>动物学分类<br>　　熊,哺乳纲,熊科动物的总称.<br>　　熊是陆上肉食类中体形最大的动物.它们是由一种类似犬一样的祖先进化而成的,是犬科动物进化道路上的一个分支.熊科动物基本上都已偏离了食肉的习性,而成为杂食性动物了.有棕熊.黑熊,北极熊,印度熊,马来熊,美洲熊等等之分.其中棕熊体积最大, 北极熊次之,一般越靠近南方的体形越小.<br>外形特征<br>　　熊躯体粗壮肥大，体毛又长又密，脸形像狗，头大嘴长，眼睛与耳朵都较小，臼齿大而发达，咀嚼力强。四肢粗壮有力，脚上长有5只锋利的爪子，用来撕开食物和爬树。尾巴短小。熊平时用脚掌慢吞吞地行走，但是当追赶猎物时，它会跑得很快，而且后腿可以直立起来。<br>　　常见的特征有短尾、极佳的嗅觉、五个无法收缩的爪，以及长、密、粗的毛。刚出生时，它的大小与天竺鼠差不多，至少要与母亲生活一年。<br>　　熊的嗅觉十分灵敏，视力以及听觉比较差。它们的牙齿是用来防御和当作工具。它们的爪子可以用来撕扯、挖掘和抓取猎物。<br>　　熊氏家庭成员体型差别较大，块头有大有小。最大的是棕熊（约780千克），北极熊次之（约700千克），然后是美洲黑熊（约220千克）、亚洲黑熊（约150千克）、懒熊（约140千克）、眼镜熊（约140千克）、马来熊（约60千克）。<br>　　速度 最快的灰熊 ，时速可以达到48KM/H，棕熊在崎岖山路速度可以达到30KM/H 速度很快。可不能认为熊的速度很慢噢，比人类快多了。<br>生活习性<br>　　大多数熊食性很杂，既食青草、嫩枝芽、苔藓、浆果和坚果，也到溪边捕捉蛙、蟹和鱼，掘食鼠类，掏取鸟卵，更喜欢舔食蚂蚁，盗取蜂蜜，甚至袭击小型鹿、羊或觅食腐尸。但是北极熊比较特殊，主要吃鱼和海豹。熊的视觉和听觉都不十分灵敏，但嗅觉非常发达。<br>　　生活于北方寒冷地区的熊有冬眠现象，而位于亚热带和热带地区的黑熊往往不冬眠。熊冬眠时间可持续4～5个月，在冬眠过程中如果被惊动它会立即苏醒，偶然也会出洞活动。熊冬眠的洞穴一般选在向阳的避风山坡或枯树洞内。除冬眠期外，熊没有固定的栖息场所。除了发情交配期外，其余时间熊都单独活动。母熊一般1年产1～4崽。<br>　　熊一般是温和的、不主动攻击人的动物，也愿意避免冲突，但当它们认为必须保卫自己或自己的幼崽、食物或地盘时，也会变成非常危险而可怕的野兽。<br>　　爱吃植物的眼镜熊：眼镜熊又叫南美熊、安第斯熊，产于南美，是现在唯一分布于南半球的熊，也是最爱吃植物性食物的一种熊，吃各种果、叶、根、茎，很少吃昆虫，因眼睛四周有白圈而得名。眼镜熊善于登高爬树，通常独自活动，偶以小家庭为单位，共住在一棵大树上。<br>　　高度近视的亚洲黑熊：亚洲黑熊又叫狗熊、月熊，还有个俗称叫黑瞎子。为什么叫它”瞎子”呢?因为它天生近视，百米之外看不清东西，不过它的耳、鼻灵敏，顺风可闻到半公里以外的气味，能听到300步以外的脚步声。别看它外表愚拙，实际上机警过人。平时黑熊以植物为主食(你一定听过黑瞎子掰苞米的故事)，在秋季却大吃昆虫等动物性食品，在体内贮存大量脂肪准备在树洞里冬眠。特长是爬树、游泳。因为眼神不济，所以练就了一身昼夜都行动自如的本领。亚洲黑熊分布于中国、印度、俄罗斯、日本、蒙古等国。<br>　　胃口极好的棕熊：棕熊遍布亚、欧、北美三大洲，其中阿拉斯加棕熊最大，最重近800公斤，站立时有两人高，是现存世界上最大的食肉目动物。而叙利亚棕熊却很小，体重不足90公斤。我国的棕熊一般在200-500公斤。棕熊的胃口可以说是好极了，荤的、素的都爱吃。植物、昆虫、蜂蜜、鱼类，甚至鹿、羊、牛、都能一概吃下，所以比较凶猛，枪法不好的猎手往往反会成为棕熊的猎物。<br>　　靠”吸尘器” 过日子的懒熊：”吸尘器”是对懒熊的嘴部功能的形象比喻。生活于印度和斯里兰卡热带森林中的懒熊形象奇特，下唇长而善动，形状像舌头，没有上门牙，嘴可以伸进昆虫藏匿的缝隙中，像吸尘器一下把猎物席卷入口。懒熊的视觉极差，靠嗅觉和听觉活动，所以它选择了夜间出击、白天酣睡的生活作风，于是人称：懒熊。小懒熊常骑在母熊背上来来去去，寸步不离，这种母子感情大大强于其他熊类的母子关系。<br>　　喜欢”假离婚”的美洲黑熊：美洲黑熊分布在加拿大及美国中部和东部的森林，别看它叫”黑熊”，其实它的身体颜色有很多种，黑色、棕色、灰色……连白色都有。美洲黑熊常在6-7月份”娶妻生子”，不过等小熊过完一周岁生日后，一家子便各奔东西，熊爸爸、熊妈妈也各自生活，看上去像”离婚”一样，可到了下一年的6-7月份，它们就复婚，重新考虑生育下一代的事。<br>　　冰山巨无霸—白熊：”冰山巨无霸”就是指北极熊，也就是白熊。它们生活在北极的莽莽冰原上，体大凶猛，以猎取海豹、幼海象、幼鲸、海鸟、鱼类为生，在北极地区是”土皇帝”，几乎打遍北极无敌手!貌似笨重的北极熊，行动十分敏捷，短跑时甚至能撵上驯鹿或北极兔。同时，它也是冰泳高手，游泳时速达10公里，潜水时间可达2 分钟，在冰水中游上百公里不在话下，堪称”半水栖兽类”。北极熊是生活在最北部、食肉性最强的一种熊。<br>　　攀爬高手—马来熊：马来熊又叫太阳熊或日熊，分布于印尼、缅甸、泰国、马来半岛及中国南部边陲的热带、亚热带山林中，是熊家族中体型最小的一种，体重只有60公斤。马来熊的看家本领是攀爬，于是它把大部分时间都花在了树上，把家也安在枝叶之间。马来熊主要吃植物果、叶以及昆虫和白蚁。夜间是马来熊的天下，而白天它却会悠闲地躺在树上晒太阳。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/熊/" data-id="cin5gpniu0082t0lmx1k57lh6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/猴" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/猴/" class="article-date">
  <time datetime="2009-10-12T05:20:46.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/猴/">猴</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>简介一<br>    猴是一个俗称。灵长目中很多动物我们都称之为猴。灵长目是哺乳纲的1目。动物界最高等的类群,大脑发达；眼眶朝向前方，眶间距窄；手和脚的趾（指）分开，大拇指灵活，多数能与其他趾（指）对握。包括原猴亚目和猿猴亚目。原猴亚目颜面似狐；无颊囊和臀胼胝；前肢短于后肢,拇指与大趾发达，能与其他指（趾）相对；尾巴能卷曲或缺如。猿猴亚目颜面似人；大都具颊囊和臀胼胝；前肢大都长于后肢，大趾有的退化；尾长、有的能卷曲，有的无尾。按区域分布或鼻孔构造，猿猴亚目又分为阔鼻猴组，又称新大陆猴类；狭鼻猴组，又称旧大陆猴类。本目包括11科约51属180种,主要分布于亚洲、非洲和美洲温暖地带。大多栖息林区。灵长类中体型最大的是大猩猩，体重可达275千克，最小的是倭猴,体重只有70克。<br>　　灵长类的大多数头骨具大的颅腔，呈球状，这是由于颌部变短，脸部变扁所致；眶后突发育形成骨质眼环，或全封闭形成眼窝；多数种类鼻子短，其嗅觉次于视觉、触觉和听觉，某些低等种类在脑中具有高度发达的嗅觉中枢，并在很大程度上靠嗅觉行动。某些狐猴有较长的鼻部。金丝猴属和豚尾叶猴属的鼻骨退化，形成上仰的鼻孔。长鼻猴属的鼻子大又长。这些特殊的类型是因肌肉或软骨发育而形成的。脚的拇趾和它趾能对握，使得手和脚成为抓握器官。原猴类的5指只能同时屈伸,不能个别运用。掌面与□面裸出,有指、趾纹,纹路形态不一。具有非常软或宽的足垫,除黑猿外,皆为□行性。多数种类的指和趾端均具扁甲。一般前后肢长相差不大，唯长臂猿科和猩猩科的前肢比后肢长得多。猿类和人无尾，在有尾的种类中,其尾长差异很大, 从只有一个突起到超过身体长。卷尾猴科大部分种类的尾巴具抓握功能，有“第五只手”之称。一些旧大陆猴(如狒狒)的脸部、臀部或胸部皮肤具鲜艳色彩，在繁殖期尤其显著。臀部有粗硬皮肤组成的硬块，称为臀胼胝。<br>    多数种类在胸部或腋下有1对乳头，而指猴的 1对乳头在腹部。雄性的阴茎是悬垂形，多数具阴茎骨，而眼镜猴、绒毛猴、人和某些种类不具。精巢包于囊中。雌体具双角子宫或单子宫。体被毛，有的柔软细密，有的粗硬，或在局部很长，或在毛上具异色环节。有的头顶毛很长，形成丛状毛冠，或甚短，呈平顶，或秃顶无毛。有的在两颊或颌下具长毛，形如胡须。有的两肩、后背、臀部被以长毛。有的体毛非常艳丽。<br>　　绝大多数灵长类动物营不同形式的树栖或半树栖生活，只有环尾狐猴、狒狒和叟猴地栖或在多岩石地区生活。通常以小家族群活动，也结大群活动。多数能直立行走，但时间不长。多在白天活动，夜间活动的有指猴、一些大狐猴、夜猴等。大倭狐猴和倭狐猴在干热季节夏眠数日至数周。<br>　　猴子大多为杂食性、吃植物性或动物性食物。选择食物和取食方法各异，如指猴善于抠食树洞或石隙中的昆虫。猩猩的食量很大，几乎把绝大部分的活动时间用以觅食。疣猴科胃的构造特殊，大部分种类吃粗纤维多的植物性食物。<br>　　猴子每年繁殖1～2次，每胎1仔，少数可多到3仔。幼体生长比较缓慢。哺乳期多抓爬在母体胸、腹部或骑在母背上，由母带着活动。性成熟的雌性有月经，雄性能在任何时间交配。只有低等猴类，如狐猴、懒猴、指猴具有一定的交配、繁殖季节。<br>　　树科的头骨特征与某些十分原始的原猴类颇相似，许多解剖学家和古生物学家曾把它包括在灵长类内，但其外部形态和生态习性却与灵长类有很大差异，因此，现代分类学家已把它独立成树目。<br>　　灵长类化石发现于北美和欧洲、亚洲的古新世至渐新世地层中，在非洲和欧洲发现于中新世，而在南美、非洲和马达加斯加则发现于更新世。灵长类的进化已有 6000万年历史，从世界各地发现的早期灵长类化石属原猴类,其中60多属现已绝灭。现在美洲已没有原猴类，只是在亚非大陆、马达加斯加岛和印度洋一些岛屿上，还生存着少数与5000万年前的原猴类极为相似的种类。猿猴类的历史可追溯到 3000～5000万年以前，大约在1500～2000万年以前，猿类的祖先就已遍布欧、亚、非三大洲，但现今却仅残存于亚洲和非洲的热带。<br>　　在我国古籍中，猴子的别称有禺，果然，独，狨等。据《白虎通》记述：“猴，侯也，见人设食伏机，则凭高四望，善于侯者也。”侯，是等待、观望的意思。<br>　　印度尼西亚加里曼丹岛的北部山区，每年5月7日是“敬猴节”。而泰国的北部山区，每年的11月1日是“猴子运动节”。<br>简介二<br>      猴是一种群居动物，据动物学家长期观察，猴也有它的社会秩序，有位高、位低之分，其中统治群猴的是一只资格较老的霸主——猴王。猴王年龄太老或过于残暴，也会激起群猴的愤怒，予以罢免或被咬得奄奄一息。据载，前不久，北京八大岭野生动物园的群猴就把一只老猴王不仅罢免，而且咬成重伤，后居然又有一新猴王继位，看来也体现了它们的社会秩序。<br>     不过在猴的社会从无谦让的美德，就和人类当中极端的个人主义者一样。有的猴王也相当残暴，它可以把地上的食物集拢成一大堆，自己把屁股坐上去，也不准其它猴子吃。每只猴子都有颊囊（即所谓脖子下面的口袋），吃不完的食物就藏在颊囊中，但绝不给其它猴子吃。有时为了抢夺食物，彼此吱吱乱叫，甚至互相追打，毫不谦让。人类常把吝啬人说成“猴奸、猴奸！”猴看来就是奸。<br>     猴子好动，自古被视为聪明伶俐的形象。在动物园观看猴子时，很少能看到它不动的样子，要么在爬山，要么在爬树，要么在吃游客喂的食物，要么在挠蚤子，更甚者在模仿人的动作。神医华佗首创五禽戏，即仿效动物姿态的一种体育治疗法，《后汉书·华佗传》记他的话：“吾有一术，名五禽之戏：一曰虎，二曰鹿，三曰熊，四曰猨，五曰鸟。亦以除疾，并利蹄足，以当导引。”猨即猿，这里是说运动时模仿猴子的姿态动作。三国时代，曹植写诗《白马篇》，吟咏马上习武的豪爽，其中“仰手接飞猱，俯身散马蹄。狡捷过猴猿”之句，颇富动态感，是因为借助了猴的形象。猱，猿一类动物，攀授树木敏捷若飞。<br>     猴子也有它的特殊习性，猴捉虱子是人们常见的，其实猴身上并没有那么多虱子，据动物学家分析，原来猴子的长毛下面，在皮肤上附有一种分泌物的结晶体，略带咸味，猴子把它找出来放入口中咀嚼得津津有味，犹如人类嗑瓜子一样，也是一种闲趣。不过，这种捉虱子的动作，往往是“位分低”的给“位分高”的捉，尤其给猴王捉，显然有巴结的意思。有时母猴也给小猴捉，这一点可能还体现了一点母爱。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/猴/" data-id="cin5gpnid007wt0lme0l9ngtv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/豹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/豹/" class="article-date">
  <time datetime="2009-10-12T04:20:30.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/豹/">豹</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>分布情况<br>    豹广泛产于中国，也广泛产于亚洲，因此有中国豹，有亚洲豹；它也广泛产于非洲，所以也有非洲豹。但是，欧洲就不产豹，澳洲(有袋类动物的老家)也不产豹。中国有3亚种：华南豹(P.pardus fusea)、华北豹(P.p.fontanieri)和东北豹(P.p.orientalis)。<br>　 中国豹最早从渐新世中期即已出现，这表明这种动物至少已生存过50万年了。<br>外形特征<br>    体型与虎相似，但较小，为大中型食肉兽类。体重50千克左右，，最重可达100千克；体长1～1.5米，尾长超过体长之半。头圆、耳短、四肢强健有力，爪锐利伸缩性强。豹全身颜色鲜亮，毛色棕黄，遍布黑色斑点和环纹，形成古钱状斑纹，故俗称之为“金钱豹”。雌雄毛色一致。其背部颜色较深，腹部为乳白色。还有一种黑化型个体，通体暗黑褐，细观仍见圆形斑，常被称为墨豹。<br>生活环境<br>    栖息于山地、丘陵、荒漠和草原，尤喜茂密的树林或大森林。无固定巢穴。单独活动。白日伏在树上，或卧在草丛中，或在悬崖的石洞中休息，夜晚出来游荡。<br>生活习性<br>      豹可以说是完美的猎手，矫健身材，灵活，奔跑时速可达65公里。即会游泳，又会爬树。性情机敏，嗅觉听觉视觉都很好，智力超常，隐蔽性强，这些是老虎狮子都办不到的。<br>　　豹的体能极强，视觉和嗅觉灵敏异常，性情机警，既会游泳，又善于爬树，成为食性广泛、胆大凶猛的食肉类。善于跳跃和攀爬，营独居夜行生活。常在林中往返游荡，捕食猿猴、野兔、野鹿和鸟类等，时而还猎食家畜。生性凶猛，伤人！<br>　　豹的猎物主要有鹿﹑羚羊及野猪，但亦会捕猎灵猫，猴子，雀鸟，啮齿动物等，甚至腐肉，视乎猎物产地而定。豹也有捕食黑猩猩的的纪录。在猎物缺乏时，它也会捕猎家畜，因而发生人豹之间的冲突。和一般猫科动物一样，豹会在密林的掩护下，潜近猎物，并来一个突袭，攻击猎物的颈部或口鼻部，令其窒息。非洲品种通常把猎物拖上树慢慢吃，以防狮子或鬣狗等食肉动物前来抢夺。在食物链上，豹处於次等捕猎者的位置，这亦意味着豹同时是老虎及狮子的猎物。<br>　　豹捕捉到的猎物如果被狮子，鬣狗狗等发现，多半会被抢走，因为豹不会同食肉动物搏击原因是一但有伤，就行动不便，上树，游泳等活动妨碍伤口愈合，加之免疫力低，所以豹宁愿再捉一个猎物也不愿同食肉动物搏击。<br>生长繁殖<br>　　繁殖期为冬末春初，3～4月份发情交配，孕期约三个月，6～7月份产仔，每胎2～3仔，初生幼体500克左右，幼豹于当年秋季就离开母豹，独立生活。约三年性成熟。寿命10～20年。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/豹/" data-id="cin5gpni3007st0lmn0o93fxc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/狮" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/狮/" class="article-date">
  <time datetime="2009-10-12T03:20:19.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/狮/">狮</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>特征<br>    雄狮重达220公斤，包括尾巴的全长达2.8米，母狮体型较公狮小，但体重仍重达160公斤，相当于两个成年男人的重量，是非洲最顶级的掠食者，公狮颈部周围包著一层的鬃毛名为”狮鬃”，狮鬃颜色不等，包括金褐、咖啡、黑色，有些狮的狮鬃浓密而杂乱，有的稀疏且平顺，科学家研究发现，狮鬃又黑又浓又乱的公狮因为长相较吓人因此很少受攻击，狮鬃太少颜色太淡看起来不吓人的公狮反而常受到攻击，狮鬃在打猎埋伏上并没有任何的帮助。有些狮体色为纯白，并不是因为白化病，而是色素细胞的突变，白狮会被认为身体虚弱，且会影响到猎食，但白狮十分的稀少。<br>生活环境<br>    过去从欧洲南部、西亚、印度和非洲都有狮。冰川期间一个亚种还在中欧和北美洲生存过，但冰川期后它们就消失了。按当时学者的报道，到古希腊时期在巴尔干半岛还有狮生存。一般认为欧洲的狮在公元1世纪由于人类的活动灭绝。<br>    今天绝大多数狮生活在非洲撒哈拉沙漠以南，撒哈拉沙漠以北的狮于1940年代灭绝。20世纪时在亚洲的狮几乎全部被消灭，只有在印度的一个自然公园还有少数幸存。<br>    过去除森林外，狮在所有的生态环境中都有，今天它们的生存环境大大地缩小了。它们比较喜欢草原，也在旱林和半沙漠中出现，但不生存在沙漠和雨林中。<br>社会结构<br>    与其它大型猫不同，狮是群体生活。一个狮群主要由互相之间有亲缘关系的雌兽组成。地形和猎物的多少决定一个群的大小，一个群可以由3至30只狮组成。雄兽在一个群内只待一段时间，此后它往往去找另一个群。虽然如此在一个狮群中雄狮的地位比雌狮的高。一般在一个狮群中只有一只成年的雄狮，幼狮在狮群中一般待三年，此后雄性的青年被驱逐出群，而雌兽则留在群内。<br>    年轻的雄狮组成不稳定的小群过着游荡的生活，直到它们自己成为一个狮群的首领。一般它们要到六岁或更老才能达到这个地位。<br>    往往一个狮群的领导地位会被另一个雄狮占据，一般当老的雄狮老了或虚弱了时，就会有年轻的雄狮向它挑战，战败的雄狮不是死亡就是逃亡。假如新来的雄狮战胜，它一般将它前任的幼兽杀死，这样雌兽就比较容易和它交配了。<br>    一个狮群的领地面积从20到400平方千米不等。一个领地的大小与狮群的大小和领地内猎物的多少有关。狮群一般用粪便、尿和从远方就听得见的呼叫声来标志它们的领地。<br>    也有的狮群没有领地而过着游荡的生活。<br>繁殖<br>    虽然雄狮在一个狮群中占最高的地位，但只有在一只雌狮同意的情况下它才能与它交配。假如雌狮愿意，它就趴到地上，让雄狮跨上。从雌狮对雄狮的态度上一般可以看得出雄狮在群中的地位有多高，以及它是否在下一次角斗中会被驱逐。<br>    雌狮的怀孕期一般是四个月，此后它生二至四只幼崽。幼崽的体重一般是1.5千克。幼崽不但可以在它的母亲身上吸奶，而且可以在群中的每只雌狮吸奶。对幼崽的抚养是整个狮群的任务。幼崽的吸奶期是四个月，此后它们还跟着母亲约两年。雌狮一般在三年后，雄狮在五年后性成熟。亦曾有研究指，雄狮跟雌狮成功交配出来超过一岁的小狮子在三只里只有一只。<br>    狮可以活20年。一般只有雌狮会活这么长。雄狮一般在此之前就会被一只年轻的雄狮杀死或驱逐，它们一般不会再找到一个群，往往饿死。一般雄狮的寿命不超过12年（与一个小学生的平均年龄持平），相反一般雌狮的寿命约15-18岁（与一个中学生的平均年龄持平）。在动物园中有些狮子活到34岁。<br>食物<br>    一般雌狮猎取食物，雄狮只在它们年轻时，鬃毛还没有完全成熟时狩猎。它们深色的鬃毛使它们比较容易被看见，因此不太容易获得成功。一般它们潜伏靠近猎物，然后跳起将猎物扑倒。小的猎物一般被咬断头颈，大的猎物的头颈被撕破或被压抑窒息。<br>    一般出猎的时间是夜晚或清晨凉爽的时候。<br>    猎物中包括羚羊、小羚羊、牛羚和斑马，也包括狒狒、兔、鸟，有时甚至鱼。猎物被捕获后按群内地位的高低捺食：首先是雄狮，然后是地位最高的雌狮，幼狮最后。往往会因此产生群内的地位争端，这样的争斗往往会导致受伤。<br>    狮子往往也食腐食。被从群内驱逐的雄狮一般只食尸体。它们抢夺其它食肉动物如豹或猎豹的猎物。狮子也从鬣狗口中抢夺食物。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/狮/" data-id="cin5gpnip0080t0lme0ickpns" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/虎" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/虎/" class="article-date">
  <time datetime="2009-10-12T02:20:08.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/虎/">虎</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>概要<br>     在亚洲许多国家的文化中，虎是美丽、勇敢、力量的象征，人们畏惧虎的凶猛，又希望具有虎的强壮，以征服它来证明力量。虎与人类的关系密切，人类的活动使虎的栖息地缩小、分隔，人虎冲突和对虎的利用造成了对虎的大肆捕杀，目前这个物种已经十分濒危。<br>进化<br>     虎由古食肉动物进化来。大型食肉类在距今700万年的新生代第三纪上新世出现并逐渐发展。古食肉类中的猫形类进化出多个分支，其中一只是古猫类，古猫类又分化为恐猫、真剑齿虎类和真猫，经过第四纪冰川期，只有真猫类存活下来，分化为猫族和豹族两个分支。现在的虎就是从真猫类中的豹族演化而来。 在虎的各个亚种中，华南虎是各亚种的祖先，它们的头骨结构最接近于原始的虎。<br>外形特征<br>     虎为大型猫科动物，斑纹独特，身体被满浅黄到红色毛，有黑色至棕色条纹。不同亚种的虎的体形大小有差异，北方虎的体形大，颜色较浅；南方的体形较小，颜色较深。虎的虹膜呈黄色，圆形瞳孔。耳背为黑色，上有明显的白斑，有科学家认为这有助于幼崽在野外跟随母亲活动。虎的前后肢十分有力。掌垫的大小与虎的年龄有关，在种群调查中，研究人员以此鉴别个体。虎的尾较长，具环形斑纹，尾尖没有长毛，为黑色。<br>习性<br>     虎是一种孤独的森林食肉动物，一般每只老虎有自己的领地，除了交配时期，从不和其他虎交往，雌虎独自生产和喂养幼虎，平均每胎产子2.46个，在野外，出生幼子的死亡率为30—40%。当幼虎成年后，雌虎将领地遗留给它，独自去寻找新领地。每个虎占领一块领地后，就会将本地所有大型食肉动物如狼、豹等赶走，所谓“占山为王”。老虎以鹿、獐、羊等食草动物为食，必须有足够的猎食领地以维持生命。虎一般采取潜伏袭击的猎食方式，从猎物后方攻击，在食物严重短缺时，也会攻击人。印度农民用头后戴假面具的方式避免遭受老虎攻击，因为虎以为假面具是人以正面对它，它决不会从正面攻击猎物。<br>虎与文化<br>     虎的象征意义在亚洲文化中得到最大的体现，被看作是美丽、严肃、勇猛的象征。在中国，虎的形象随处可见，许多神明信仰以虎为象征，如西王母、保生大帝、玄坛真君等。在台湾民间信仰，则奉城隍、山神、土地公所乘之虎为神，谓曰虎爷，有驱邪之能。虎字起源极早，殷墟甲骨文中就有虎字，现在汉字中的虎就很像一只虎。民间传说，汉字中的“王”就来自于老虎前额上的斑纹，还有许多成语、民间俗语中都有虎出现。虎在十二生肖中排名第三位。<br>     早在5000年前的印度河古文化中（今巴基斯坦一带）就发现有雕刻在图章上的虎的形象。印度教种有一个骑虎的女神杜伽（Durga），这个女神的形象在印度随处可见，多出现在火车两侧。韩国的野生虎虽已经灭绝，但韩国人仍称自己的国度为“青龙白虎之邦”，在1988年汉城奥运会2002年韩日世界杯上，虎都被定为吉祥物。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/虎/" data-id="cin5gpni8007ut0lmqfatzg7w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/狼" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/狼/" class="article-date">
  <time datetime="2009-10-12T01:19:51.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/狼/">狼</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>外形特征<br>　　外形有小（郊狼）、中（森林狼）、大（草原狼），吻尖长，眼角微上挑。因为产地和基因不同，所以毛色也不同。常见灰黄两色，还有黑红白等色，个别还有紫蓝等色，胸腹毛色较浅。腿细长强壮，善跑。灰狼的体重和体型大小各地区不一样,一般有随纬度的增加而成正比增加的趋势这一说法. 一般来说,肩高在( 26-36英寸) ,体重32-62公斤( 70-135磅) 野生狼体重记录————其中1939年在阿拉斯加被打死的一只,,当时80公斤( 175磅) . 最小的狼是阿拉伯狼,雌性的狼有的体重可低至10公斤( 22磅) 狼群适合长途迁行捕猎.其强大的背部和腿部,能有效地舒展奔跑.<br>生活习性<br>    狼是群居性极高的物种。一群狼的数量大约在5到12只之间，在冬天寒冷的时候最多可到四十只左右，通常以家庭为单位的家庭狼由一对优势对偶领导，而以兄弟姐妹为一群的则以最强一头狼领导。狼群有领域性，且通常也都是其活动范围，群内个体数量若增加，领域范围会缩小。群之间的领域范围不重叠，会以嚎声向其他群宣告范围。幼狼成长后，会留在群内照顾弟妹，也可能继承群内优势地位，有的则会迁移出去（大都为雄狼）而还有一些情况下会出现迁徙狼，以百来头为一群，有来自不同家庭等级的各类狼，各个小团体原狼首领会成为头狼，头狼中最出众的则会成为狼王。野生的狼一般可以活12——16年，人工饲养的狼有的可以活到二十年左右。 奔跑速度极快，可达五十五公里左右，持久性也很好。它们有能力以速度10公里/小时(六英里)长时间奔跑 , 并能以高达近65公里/小时速度( 40英里) 追猎冲刺。 如果是长跑，它的速度会超过猎豹。智能颇高，可以气味、叫声沟通。狼是以肉食为主的杂食性动物,是生物链中极关键的一节。<br>生长繁殖<br>　　狼的怀孕期为61天左右。低海拔的狼一月交配，高海拔则在四月交配。<br>　　小狼两周后睁眼，五周后断奶，八周后被带到狼群聚集处。<br>　　狼成群生活，雌雄性分为不同等级，占统治地位的雄狼和雌狼随心所欲进行繁殖，处于低下地位的个体则不能自由选择。雌狼产子于地下洞穴中，雌狼经过六十叁天的怀孕期，生下叁只到九只小狼，也有生十几只的。没有自卫能力的小狼，要在洞穴里过一段日子，公狼负责猎取食物。小狼吃奶时期大约有五、六个月之久，但是一个半月也可以吃些碎肉。叁、四个月大的小狼就可以跟随父母一道去猎食。半年后，小狼就学会自己找食物吃了。狼的寿命大约是十二到十四年。在群体中成长的小狼，非但父母呵护备至，而且，族群的其他份子也会爱护有加。狼和非洲土狼会将杀死的猎物，撕咬成碎片，吃下腹内，待回到小狼身边时，再吐出食物反哺。赤狼有时也会在族群中造一育儿所，将小狼集中养育，由母赤狼轮流抚育小狼，毫无怨尤。因此，我们可以说狼的家庭观念极强。<br>狼的行为模式和身体语言<br>    一般占优势主导地位的狼会身挺高腿直，神态坚定，耳朵是直立向前。<br>　　往往尾部纵向卷曲朝背部。这种显示的是级别高主导地位的狼可能一直盯着一个唯唯诺诺的地位低下的狼。<br>　　活跃—玩耍时，狼会全身伏低，嘴唇和耳朵向两边拉开，有时会主动舔或快速伸出舌头。<br>　　愤怒—愤怒的狼的耳朵会竖立，背毛也会竖立，唇可卷起或后翻，门牙露出，有时也会弓背或咆哮。.<br>　　恐惧—害怕时狼会试图把它的身子显得较小，从而不那么显眼，或拱背防守，尾收回。<br>文化<br>    狼本身并无所谓狡猾或贪婪之本性，但狼在狩猎时的习性以及智慧，往往被引申为凶残恶毒，并用来形容贪婪，凶邪或忘恩负义的人，如“狼心狗肺”，“狼狈为奸”，“狼子野心”等。另外欧亚中部游牧民族因其生存环境，可能会崇拜合群，勇猛的狼，突厥、乌孙都以狼为图腾。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/狼/" data-id="cin5gpnik007yt0lmy8dx39qr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/教条示龙场诸生-明-王守仁" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/教条示龙场诸生-明-王守仁/" class="article-date">
  <time datetime="2009-10-12T00:18:28.000Z" itemprop="datePublished">2009-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/教条示龙场诸生-明-王守仁/">教条示龙场诸生(明.王守仁)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>　　诸生相从于此，甚盛。恐无能为助也，以四事相规，聊以答诸生之意。一曰立志，二曰勤学，三曰改过，四曰责善。其慎听，毋忽！<br>立志<br>　　志不立，天下无可成之事。虽百工技艺，未有不本于志者。今学者旷废隳惰，玩岁愒时，而百无所成，皆由于志之未立耳。故立志而圣，则圣矣；立志而贤，则贤矣；志不立，如无舵之舟，无衔之马，漂荡奔逸，终亦何所底乎？昔人所言：“使为善而父母怒之，兄弟怨之，宗族乡党贱恶之，如此而不为善，可也。为善则父母爱之，兄弟悦之，宗族乡党敬信之，何苦而不为善、为君子？使为恶而父母爱之，兄弟悦之，宗族乡党敬信之，如此而为恶，可也。为恶则父母怒之，兄弟怨之，宗族乡党贱恶之，何苦必为恶、为小人？”诸生念此，亦可以知所立志矣。<br>勤学<br>　　已立志为君子，自当从事于学。凡学之不勤，必其志之尚未笃也。从吾游者，不以聪慧警捷为高，而以勤确谦抑为上。诸生试观侪辈之中，苟有“虚而为盈，无而为有”讳己之不能，忌人之有善，自矜自是，大言欺人者，使其人资禀虽甚超迈，侪辈之中，有弗疾恶之者乎？有弗鄙贱之者乎？彼固将以欺人，人果遂为所欺，有弗窃笑之者乎？苟有谦默自持，无能自处，笃志力行，勤学好问；称人之善，而咎己之失；从人之长，而明己之短；忠信乐易，表里一致者；使其人资禀虽甚鲁钝，侪辈之中，有弗称慕之者乎？彼固以无能自处，而不求上人，人果遂以彼为无能，有弗敬尚之者乎？诸生观此，亦可以知所从事于学矣！<br>改过<br>　　夫过者，自大贤所不免；然不害其卒为大贤者，为其能改也。故不贵于无过，而贵于能改过。诸生自思，平日亦有缺于廉耻忠信之行者乎？亦有薄于孝友之道，陷于狡诈、偷刻之习者乎？诸生殆不至于此。不幸或有之，皆其不知而误蹈，素无师友之讲习规饬也。诸生试内省，万一有近于是者，固亦不可以不痛自悔咎；然亦不当以此自歉，遂馁于改过从善之心。但能一旦脱然洗涤旧染，虽昔为盗寇，今日不害为君子矣！若曰吾昔已如此，今虽改过而从善，人将不信我，且无赎于前过，反怀羞涩疑沮，而甘心于污浊终焉，则吾亦绝望尔矣！<br>责善<br>　　“责善，朋友之道；”然须“忠告而善道之”，悉其忠爱，致其婉曲，使彼闻之而可从，绎之而可改，有所感而无所怒，乃为善耳！若先暴白其过恶，痛毁极诋，使无所容，彼将发其愧耻愤恨之心；虽欲降以相从，而势有所不能。是激之而使为恶矣！故凡讦人之短，攻发人之阴私，以沽直者，皆不可以言责善。虽然，我以是而施于人，不可也；人以是而加诸我，凡攻我之失者，皆我师也，安可以不乐受而心感之乎？某于道未有所得，其学卤莽耳。谬为诸生相从于此．每终夜以思，恶且未免，况于过乎？人谓“事师无犯无隐”，而遂谓师无可谏，非也。谏师之道，直不至于犯，而婉不至于隐耳。使吾而是也，因得以明其是；吾而非也，因得以去其非。盖教学相长也。诸生责善，当自吾始。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/教条示龙场诸生-明-王守仁/" data-id="cin5gpnj00084t0lmuoc5whsq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2009/三戒-唐-柳宗元" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2009/三戒-唐-柳宗元/" class="article-date">
  <time datetime="2009-10-10T15:17:26.000Z" itemprop="datePublished">2009-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/读书/">读书</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2009/三戒-唐-柳宗元/">三戒(唐.柳宗元)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>临江之麋<br>      临江之人，畋得麋麑，畜之。入门，群犬垂涎，扬尾皆来。其人怒，怛之。自是日抱就犬，习示之，使勿动，稍使与之戏。积久，犬皆如人意。麋麑稍大，忘己之麋也，以为犬良我友，抵触偃仆，益狎。犬畏主人，与之俯仰甚善。然时啖其舌。<br>      三年，麋出门，见外犬在道甚众，走欲与为戏。外犬见而喜且怒，共杀食之，狼藉道上。麋至死不悟。</p>
<p>黔之驴<br>      黔无驴，有好事者船载以入。至则无可用，放之山下。虎见之，庞然大物也，以为神。蔽林间窥之，稍出近之，慭慭然，莫相知。<br>      他日，驴一鸣，虎大骇，远遁，以为且噬己也，甚恐。然往来视之，觉无异能者，益习其声，又近出前后，终不敢搏。稍近益狎，荡倚冲冒，驴不胜怒，蹄之。虎因喜，计之曰：“技止此耳！”因跳踉大㘎，断其喉，尽其肉，乃去。<br>      噫，形之庞也类有德，声之宏也类有能，向不出其技，虎虽猛，疑畏卒不敢取；今若是焉，悲夫！</p>
<p>永某氏之鼠<br>      永有某氏者，畏日，拘忌异甚。以为己生岁直子，鼠，子神也，因爱鼠，不畜猫犬，禁僮勿击鼠。仓廪庖厨，悉以恣鼠不问。<br>      由是鼠相告，皆来某氏，饱食而无祸。某氏室无完器，椸无完衣，饮食大率鼠之余也。昼累累与人兼行，夜则窃啮斗暴，其声万状，不可以寝，终不厌。<br>      数岁，某氏徙居他州。后人来居，鼠为态如故。其人曰：“是阴类恶物也，盗暴尤甚，且何以至是乎哉？”假五六猫，阖门，撤瓦灌穴，购僮罗捕之。杀鼠如丘，弃之隐处，臭（上自下死）数月乃已。<br>      呜呼！彼以其饱食无祸为可恒也哉！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2009/三戒-唐-柳宗元/" data-id="cin5gpnja0088t0lm5ev2a8pr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2008/JNI实战" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2008/JNI实战/" class="article-date">
  <time datetime="2008-04-01T15:15:01.000Z" itemprop="datePublished">2008-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/JNI实战/">JNI实战</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>JNI即是Java Native Interface，主要用来Java和其他语言之间的交互，多半是和平台依赖的调用、其他高级语言的库甚至是低级语言交互。相信大家平时在JDK中看到很多native的方法，但是自己写JNI应用的会确很少。这次因为在进行开发中，遇到需要Java调用一个现成的成熟的功能完善的C语言应用库，因此 JNI便成了Java和C库之间的桥的功能。既然是初探，那么下面我们就从HelloWorld开始吧：虽然Java是一个跨平台的语言，但是C语言是一个和平台密切相关的语言；所以针对Unix、Linux、Windows等不同的操作系统，C语言的预编译，动态库的创建等都有一些差别，也需要我们分别进行处理之。下面仅基于Sun的Unix平台Sun Solaris开发为例。<br>1.首先声明第一个Java native程序：HelloWorld.java。<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HelloWorld</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> native <span class="keyword">int</span> <span class="title">hello</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hello();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * @param args</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">        HelloWorld hw = <span class="keyword">new</span> HelloWorld();</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"Say in Java:"</span> + hw.sayHello());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"Starting to load HelloWorld lib."</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.loadLibrary(<span class="string">"HelloWorld"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"Load unsuccessfully."</span>);</span><br><span class="line">            t.printStackTrace();</span><br><span class="line">            System.exit(-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"Load successfully."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2.编译该Java文件。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">javac</span> <span class="tag">HelloWorld</span><span class="class">.java</span></span><br></pre></td></tr></table></figure></p>
<p>3.生成相应的C语言的HelloWorld.h头文件，javah HelloWorld，头文件内容如下：(其中，static Java方法和非static Java方法经过javah -jni生成的C头文件是有区别的，差异在于参数，static Java方法生成的相应的C方法的第二个参数是jclass类型，非static Java方法生成的相应的C方法的第二个参数是jobject类型。)<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">more</span> HelloWorld.<span class="literal">h</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* DO NOT EDIT THIS FILE - it is machine generated */</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;jni.h&gt;</span></span><br><span class="line"><span class="comment">/* Header for class HelloWorld */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#ifndef _Included_HelloWorld</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> _Included_HelloWorld</span></span><br><span class="line"><span class="preprocessor">#ifdef __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> &#123;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*</span><br><span class="line"> * Class:     HelloWorld</span><br><span class="line"> * Method:    hello</span><br><span class="line"> * Signature: ()I</span><br><span class="line"> */</span></span><br><span class="line"><span class="function">JNIEXPORT jint JNICALL <span class="title">Java_HelloWorld_hello</span></span><br><span class="line">  <span class="params">(JNIEnv *, jobject)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#ifdef __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="number">4.</span>开始编写第一个c语言的JNI的本地(native)方法:</span><br><span class="line">vi HelloWorld.c</span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;jni.h&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> "HelloWorld.h"</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function">JNIEXPORT jint JNICALL <span class="title">Java_HelloWorld_hello</span></span><br><span class="line"><span class="params">(JNIEnv* env, jobject target)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Hello World in C program!!!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.生成Unix下的动态库.so文件：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cc</span> -<span class="keyword">G</span> -I. -I<span class="label">$JAVA_HOME</span>/<span class="keyword">include</span> -I<span class="label">$JAVA_HOME</span>/<span class="keyword">include</span>/solaris HelloWorld.c -o libHelloWorld.<span class="keyword">so</span></span><br></pre></td></tr></table></figure></p>
<p>在当前目录下看到新生成的libHelloWorld.so文件。也许你会注意到我们在Java程序中System.loadLibrary()加载的是库HelloWorld，那么这其实是一个命名的规范而已。以lib开头的.so文件即是Unix下的动态库，而JNI加载器通过HelloWorld这个名字实际上希望加载的动态库是libHelloWorld.so。<br>6.设置环境变量，查看LD_LIBRARY_PATH并设置：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">vi</span> <span class="class">.cshrc</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">setenv</span> LD_LIBRARY_PATH <span class="string">'.:/usr/local/lib:<span class="variable">$LD_LIBRARY_PATH</span>'</span></span><br><span class="line">source .cshrc</span><br></pre></td></tr></table></figure>
<p>这个环境变量设置的是Java的动态库加载器需要加载的C动态库所在的路径。因此，我们生成的libHelloWorld.so一定要在这个环境变量中设置，在这个例子中我就把当前目录.加到环境变量LD_LIBRARY_PATH了:)<br>7.执行HelloWorld文件，java HelloWorld，在标准输出上看到：<br><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Starting to load HelloWorld lib.</span><br><span class="line">Load successfully.</span><br><span class="line">Hello World in C program!!!</span><br><span class="line"><span class="keyword">Say</span> in Java:2</span><br></pre></td></tr></table></figure></p>
<p>一切Okey,如此的easy,一阵狂喜！接下来就是将这个例子运用于JNI的开发之中了。</p>
<p>Resource:<br>《Java Native Interface: Programmer’s Guide and Specification》<br><a href="http://java.sun.com/docs/books/jni/html/start.html#27008" target="_blank" rel="external">http://java.sun.com/docs/books/jni/html/start.html#27008</a><br><a href="http://linuxmafia.com/faq/Admin/ld-lib-path.html" target="_blank" rel="external">http://linuxmafia.com/faq/Admin/ld-lib-path.html</a><br><a href="https://www6.software.ibm.com/developerworks/cn/education/java/j-jni/tutorial/j-jni-2-15.html" target="_blank" rel="external">https://www6.software.ibm.com/developerworks/cn/education/java/j-jni/tutorial/j-jni-2-15.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2008/JNI实战/" data-id="cin5gpnkr0092t0lmig3mns8f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JNI/">JNI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2008/Java-NIO-TCP编程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2008/Java-NIO-TCP编程/" class="article-date">
  <time datetime="2008-03-31T15:05:27.000Z" itemprop="datePublished">2008-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/Java-NIO-TCP编程/">Java NIO TCP编程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在Java1.4以前，Java的网络编程是只有阻塞方式的，在Java1.4以及之后，Java提供了非阻塞的网络编程API.从Java的发展来看，由于Java的快速发展，JVM性能的提升，涉足到服务端应用程序开发也越来越多，要求高性能的网络应用越来越多，这是Java推出非阻塞网络编程的最主要原因吧。<br>对我而言，以前的大部分服务端应用主要是搭建在应用服务器之上，所以通讯这部分工作都是有应用服务器来实现和管理的。这次由于通讯和协议，我们必须自己实现一个能处理大量并发客户端的高性能并行处理的Java服务端程序。因此，选择非阻塞的处理方式也是必然的。我们首先来看看阻塞的处理方式：<br>在阻塞的网络编程方式中，针对于每一个单独的网络连接，都必须有一个线程对应的绑定该网络连接，进行网络字节流的处理。下面是一段代码：<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ServerSocket ssc = <span class="keyword">new</span> ServerSocket(<span class="number">23456</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"Enter Accept:"</span>);</span><br><span class="line">            Socket s = ssc.accept();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                (<span class="keyword">new</span> Thread(<span class="keyword">new</span> Worker(s))).start();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO</span></span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Worker</span> <span class="title">implements</span> <span class="title">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Socket s;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> boolean running = <span class="keyword">true</span>;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Worker</span>(<span class="params">Socket s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.s = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream <span class="keyword">is</span> = s.getInputStream();</span><br><span class="line">            OutputStream os = s.getOutputStream();</span><br><span class="line">            <span class="keyword">while</span> (running) &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] b = <span class="keyword">this</span>.readByLength(<span class="keyword">is</span>, <span class="number">1024</span>);</span><br><span class="line">                <span class="keyword">this</span>.process(b);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO</span></span></span><br><span class="line">            t.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] readByLength(InputStream <span class="keyword">is</span>, <span class="keyword">int</span> contLen) throws IOException &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[contLen];</span><br><span class="line">        <span class="keyword">int</span> off = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((length = <span class="keyword">is</span>.read(b, off, contLen - off)) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            off = +length;</span><br><span class="line">            <span class="keyword">if</span> (off &gt;= contLen) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">process</span>(<span class="params"><span class="keyword">byte</span>[] b</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在这段代码中，我们看到有两个阻塞的方法，是ServerSocket的accept()方法；和InputStream的read()方式。因此我们需要两类型的线程分别进行处理。而且每一个阻塞方法所绑定的线程的生命周期和网络连接的生命周期是一致的。基于以上的原因，NIO应运而生，一方面，为每一个网络连接建立一个线程对应，同时每一个线程有大量的线程处于读写以外的空闲状态，因此希望降低线程的数量，降低每个空闲状态，提高单个线程的运行执行效率，实际上是在更加充分运用CPU的计算、运行能力(因为，如果有大量的链路存在，就存在大量的线程，而大量的线程都阻塞在read()或者write()方法，同时CPU又需要来回频繁的在这些线程中间调度和切换,必然带来大量的系统调用和资源竞争.)；另外一方面希望提高网络IO和硬盘IO操作的性能。在NIO主要出现了三个新特性：<br>1.数据缓冲处理(ByteBuffer):由于操作系统和应用程序数据通信的原始类型是byte,也是IO数据操作的基本单元，在NIO中，每一个基本的原生类型(boolean除外)都有Buffer的实现：CharBuffer、IntBuffer、DoubleBuffer、ShortBuffer、LongBuffer、FloatBuffer和ByteBuffer，数据缓冲使得在IO操作中能够连续的处理数据流。当前有两种ByteBuffer，一种是Direct ByteBuffer，另外一种是NonDirect ByteBuffer；ByteBuffer是普通的Java对象，遵循Java堆中对象存在的规则；而Direct ByteBuffer是native代码，它内存的分配不在Java的堆栈中，不受Java内存回收的影响，每一个Direct ByteBuffer都是直接分配的一块连续的内存空间，也是NIO提高性能的重要办法之一。另外数据缓冲有一个很重要的特点是，基于一个数据缓冲可以建立一个或者多个逻辑的视图缓冲(View Buffer).比方说，通过View Buffer,可以将一个Byte类型的Buffer换作Int类型的缓冲；或者一个大的缓冲转作很多小的Buffer。之所以称为View Buffer是因为这个转换仅仅是逻辑上，在物理上并没有创建新的Buffer。这为我们操作Buffer带来诸多方便。<br>2.异步通道(Channel)：Channel是一个与操作系统紧密结合的本地代码较多的对象。通过Channel来实现网络编程的非阻塞操作，同时也是其与ByteBuffer、Socket有效结合充分利用非阻塞、ByteBuffer的特性的。在后面我们会看到具体的SocketChannel的用法。<br>3.有条件的选择(Readiness Selection):大多数操作系统都有支持有条件选择准备就绪IO通道的API，即能够保证一个线程同时有效管理多个IO通道。在NIO中，由Selector(维护注册进来的Channel和这些Channel的状态)、SelectableChannel(能被Selector管理的Channel)和SelectionKey(SelectionKey标识Selector和SelectableChannel之间的映射关系，一旦一个Channel注册到Selector中，就会返回一个SelectionKey对象。SelectionKey保存了两类状态：对应的Channel注册了哪些操作；对应的Channel的那些操作已经准备好了，可以进行相应的数据操作了)结合来实现这个功能的。<br>NIO非阻塞的典型编程模型如下：<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">private Selector selector = null;</span><br><span class="line"></span><br><span class="line">private static final int BUF_LENGTH = <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">public void start<span class="params">()</span> throws IOException &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="params">(selector != null)</span> &#123;</span><br><span class="line">        selector = Selector.open<span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ServerSocketChannel ssc = ServerSocketChannel.open<span class="params">()</span>;</span><br><span class="line">    ServerSocket serverSocket = ssc.socket<span class="params">()</span>;</span><br><span class="line">    serverSocket.bind<span class="params">(new InetSocketAddress<span class="params">(<span class="number">80</span>)</span>)</span>;</span><br><span class="line">    ssc.configureBlocking<span class="params">(<span class="literal">false</span>)</span>;</span><br><span class="line">    ssc.register<span class="params">(selector, SelectionKey.OP_ACCEPT)</span>;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        while <span class="params">(<span class="literal">true</span>)</span> &#123;</span><br><span class="line">            int nKeys = UnblockServer.this.selector.select<span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="params">(nKeys &gt; <span class="number">0</span>)</span> &#123;</span><br><span class="line">                Iterator it = selector.selectedKeys<span class="params">()</span>.iterator<span class="params">()</span>;</span><br><span class="line">                while <span class="params">(it.hasNext<span class="params">()</span>)</span> &#123;</span><br><span class="line">                    SelectionKey key = <span class="params">(SelectionKey)</span> it.next<span class="params">()</span>;</span><br><span class="line">                    <span class="keyword">if</span> <span class="params">(key.isAcceptable<span class="params">()</span>)</span> &#123;</span><br><span class="line">                        ServerSocketChannel server = <span class="params">(ServerSocketChannel)</span> key.channel<span class="params">()</span>;</span><br><span class="line">                        SocketChannel channel = server.accept<span class="params">()</span>;</span><br><span class="line">                        <span class="keyword">if</span> <span class="params">(channel == null)</span> &#123;</span><br><span class="line">                            continue;</span><br><span class="line">                        &#125;</span><br><span class="line">                        channel.configureBlocking<span class="params">(<span class="literal">false</span>)</span>;</span><br><span class="line">                        channel.register<span class="params">(selector, SelectionKey.OP_READ)</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> <span class="params">(key.isReadable<span class="params">()</span>)</span> &#123;</span><br><span class="line">                        readDataFromSocket<span class="params">(key)</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    it.remove<span class="params">()</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch <span class="params">(IOException ioe)</span> &#123;</span><br><span class="line">        ioe.printStackTrace<span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * @param key</span><br><span class="line"> * @throws IOException</span><br><span class="line"> */</span></span><br><span class="line">private void readDataFromSocket<span class="params">(SelectionKey key)</span> throws IOException &#123;</span><br><span class="line">    ByteBuffer buf = ByteBuffer.allocate<span class="params">(BUF_LENGTH)</span>;</span><br><span class="line">    SocketChannel sc = <span class="params">(SocketChannel)</span> key.channel<span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    int readBytes = <span class="number">0</span>;</span><br><span class="line">    int ret;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        while <span class="params">(<span class="params">(ret = sc.read<span class="params">(buf.buf<span class="params">()</span>)</span>)</span> &gt; <span class="number">0</span>)</span> &#123;</span><br><span class="line">            readBytes += ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        buf.flip<span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// process buffer</span></span><br><span class="line">    <span class="comment">// buf.clear();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从这段程序，我们基本可以了解到NIO网络编程的一些特点，创建一个SocketServer的方式已经发生了变化，需要指定非阻塞模式，需要创建一个Channel然后注册到Selector中去，同样，建立一个网络连接过程也是一样的模式,然后就是有条件的选择(Readiness Selection).这样，我们的每一个线程只需要处理一类型的网络选择。在代码上，我们发现处理的方式和阻塞完全不一样了，我们需要完全重新考虑如何编写网络通信的模块了：<br>1.持久连接的超时问题(Timeout)，因为API没有直接的支持timeout的参数设置功能，因此需要我们自己实现一个这样功能。<br>2.如何使用Selector，由于每一个Selector的处理能力是有限的，因此在大量链接和消息处理过程中，需要考虑如何使用多个Selector.<br>3.在非阻塞情况下，read和write都不在是阻塞的，因此需要考虑如何完整的读取到确定的消息；如何在确保在网络环境不是很好的情况下，一定将数据写进IO中。<br>4.如何应用ByteBuffer，本身大量创建ByteBuffer就是很耗资源的；如何有效的使用ByteBuffer？同时ByteBuffer的操作需要仔细考虑，因为有position()、mark()、limit()、capacity等方法。<br>5.由于每一个线程在处理网络连接的时候，面对的都是一系列的网络连接，需要考虑如何更好的使用、调度多线程。在对消息的处理上，也需要保证一定的顺序，比方说，登录消息最先到达，只有登录消息处理之后，才有可能去处理同一个链路上的其他类型的消息。<br>6.在网络编程中可能出现的内存泄漏问题。<br>在NIO的接入处理框架上，大约有两种并发线程：<br>1.Selector线程，每一个Selector单独占用一个线程，由于每一个Selector的处理能力是有限的，因此需要多个Selector并行工作。<br>2.对于每一条处于Ready状态的链路，需要线程对于相应的消息进行处理；对于这一类型的消息，需要并发线程共同工作进行处理。在这个过程中，不断可能需要消息的完整性；还要涉及到，每个链路上的消息可能有时序，因此在处理上，也可能要求相应的时序性。<br>当前社区的开源NIO框架实现有MINA、Grizzly、NIO framework、QuickServer、xSocket等，其中MINA和Grizzly最为活跃，而且代码的质量也很高。他们俩在实现的方法上也完全大不一样。(大部分Java的开源服务器都已经用NIO重写了网络部分。 )<br>不管是我们自己实现NIO的网络编程框架，还是基于MINA、Grizzly等这样的开源框架进行开发，都需要理解确定的了解NIO带来的益处和NIO编程需要解决的众多类型的问题。充足、有效的单元测试，是我们写好NIO代码的好助手:)</p>
<p>Resource:<br><a href="http://www.cis.temple.edu/~ingargio/cis307/readings/unix4.html#states" target="_blank" rel="external">http://www.cis.temple.edu/~ingargio/cis307/readings/unix4.html#states</a><br><a href="http://www.douban.com/subject/1433583/" target="_blank" rel="external">《Java NIO》</a><br><a href="http://www.douban.com/subject/2306878/" target="_blank" rel="external">《GlassFish—开源的Java EE应用服务器》</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://navigating.github.io/2008/Java-NIO-TCP编程/" data-id="cin5gpnkj008yt0lmq1q1htsc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NIO/">NIO</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/6/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/8/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">78</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a><span class="category-list-count">25</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Ambari/" style="font-size: 11.25px;">Ambari</a> <a href="/tags/Android/" style="font-size: 13.75px;">Android</a> <a href="/tags/Annotation/" style="font-size: 10px;">Annotation</a> <a href="/tags/Apple/" style="font-size: 10px;">Apple</a> <a href="/tags/Architecture/" style="font-size: 13.75px;">Architecture</a> <a href="/tags/BigData/" style="font-size: 20px;">BigData</a> <a href="/tags/CDH/" style="font-size: 15px;">CDH</a> <a href="/tags/Cassandra/" style="font-size: 10px;">Cassandra</a> <a href="/tags/Cloudera/" style="font-size: 10px;">Cloudera</a> <a href="/tags/Eclipse/" style="font-size: 10px;">Eclipse</a> <a href="/tags/Flume/" style="font-size: 10px;">Flume</a> <a href="/tags/Google/" style="font-size: 11.25px;">Google</a> <a href="/tags/HBase/" style="font-size: 16.25px;">HBase</a> <a href="/tags/HDP/" style="font-size: 16.25px;">HDP</a> <a href="/tags/HQueue/" style="font-size: 10px;">HQueue</a> <a href="/tags/Hadoop/" style="font-size: 20px;">Hadoop</a> <a href="/tags/Hive/" style="font-size: 12.5px;">Hive</a> <a href="/tags/Impala/" style="font-size: 11.25px;">Impala</a> <a href="/tags/JNI/" style="font-size: 10px;">JNI</a> <a href="/tags/JUnit/" style="font-size: 11.25px;">JUnit</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 17.5px;">Java</a> <a href="/tags/Kafka/" style="font-size: 11.25px;">Kafka</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MapR/" style="font-size: 10px;">MapR</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/NIO/" style="font-size: 12.5px;">NIO</a> <a href="/tags/Netty/" style="font-size: 11.25px;">Netty</a> <a href="/tags/NoSQL/" style="font-size: 10px;">NoSQL</a> <a href="/tags/Oozie/" style="font-size: 10px;">Oozie</a> <a href="/tags/Performance/" style="font-size: 10px;">Performance</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Review/" style="font-size: 10px;">Review</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/SOA/" style="font-size: 10px;">SOA</a> <a href="/tags/SQL-on-Hadoop/" style="font-size: 11.25px;">SQL on Hadoop</a> <a href="/tags/Spark/" style="font-size: 18.75px;">Spark</a> <a href="/tags/Storm/" style="font-size: 10px;">Storm</a> <a href="/tags/Tez/" style="font-size: 11.25px;">Tez</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/XP/" style="font-size: 11.25px;">XP</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 11.25px;">hexo</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/iStream/" style="font-size: 10px;">iStream</a>
    </div>
  </div>

  
    <div class="widget-wrap">
  <input type="text" class="st-default-search-input">
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/学习《Real-Time Event Streaming What Are Your Options》/">学习《Real-Time Event Streaming What Are Your Options》</a>
          </li>
        
          <li>
            <a href="/2016/大数据动态之2016Q2/">大数据动态之2016Q2</a>
          </li>
        
          <li>
            <a href="/2016/大数据动态之2016Q1/">大数据动态之2016Q1</a>
          </li>
        
          <li>
            <a href="/2015/大数据动态之2015Q4/">大数据动态之2015Q4</a>
          </li>
        
          <li>
            <a href="/2015/JVM监控与调优/">JVM监控与调优</a>
          </li>
        
          <li>
            <a href="/2015/大数据动态之201509/">大数据动态之201509</a>
          </li>
        
          <li>
            <a href="/2015/学习《Impala-vs-Hive-Performance-Benchmark》/">学习《Impala vs. Hive Performance Benchmark》</a>
          </li>
        
          <li>
            <a href="/2015/Hortonworks-HDP-2-3-0/">Hortonworks HDP 2.3.0</a>
          </li>
        
          <li>
            <a href="/2015/Oozie：入门概述/">Oozie：入门概述</a>
          </li>
        
          <li>
            <a href="/2015/大数据技术百度指数201508/">大数据技术百度指数201508</a>
          </li>
        
          <li>
            <a href="/2015/大数据动态之201508/">大数据动态之201508</a>
          </li>
        
          <li>
            <a href="/2015/SparkOnHBase-Cloudera/">SparkOnHBase(Cloudera)</a>
          </li>
        
          <li>
            <a href="/2015/学习《Hadoop生态技术在阿里全网商品搜索实战》/">学习《Hadoop生态技术在阿里全网商品搜索实战》</a>
          </li>
        
          <li>
            <a href="/2015/Hadoop发行版(2015第二季)/">Hadoop发行版(2015第二季)</a>
          </li>
        
          <li>
            <a href="/2015/学习《七牛是如何搞定每天500亿条日志的》/">学习《七牛是如何搞定每天500亿条日志的》</a>
          </li>
        
          <li>
            <a href="/2015/学习《腾讯在Spark上的应用与实践优化》/">学习《腾讯在Spark上的应用与实践优化》</a>
          </li>
        
          <li>
            <a href="/2015/13-14年收集的大数据的一些技术架构图/">13~14年收集的大数据的一些技术架构图</a>
          </li>
        
          <li>
            <a href="/2015/读《微软研发制胜策略》/">读《微软研发制胜策略》</a>
          </li>
        
          <li>
            <a href="/2015/大数据动态之201507/">大数据动态之201507</a>
          </li>
        
          <li>
            <a href="/2015/使用Hexo搭建Github静态博客/">使用Hexo搭建Github静态博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">八月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">十一月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">十月 2011</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">三月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">十一月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">九月 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/08/">八月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">六月 2010</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">五月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">四月 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">三月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">一月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/12/">十二月 2009</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">十月 2009</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/04/">四月 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/03/">三月 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/11/">十一月 2007</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/08/">八月 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/07/">七月 2007</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/06/">六月 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/05/">五月 2007</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/03/">三月 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/12/">十二月 2006</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/11/">十一月 2006</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/10/">十月 2006</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/08/">八月 2006</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/04/">四月 2006</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/09/">九月 2005</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/08/">八月 2005</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/05/">五月 2005</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/02/">二月 2005</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/01/">一月 2005</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2004/12/">十二月 2004</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2004/11/">十一月 2004</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2004/10/">十月 2004</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2004/09/">九月 2004</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Steven Xu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/sitemap.xml" class="mobile-nav-link">Sitemap</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>